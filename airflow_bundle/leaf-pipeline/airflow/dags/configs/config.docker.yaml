# io:
#   # IMPORTANT: use the Docker service name of Postgres (from your compose):
#   postgres_url: "postgresql+psycopg2://missions_user:pg123@postgres:5432/missions_db"
io:
  postgres_url: "postgresql+psycopg2://postgres:postgres@agcloud-postgres:5432/postgres"


windows:
  frequency: "D"
  timezone: "UTC"

source_mapping:
  entity_dim: "mission"        # or "region"/"device"
  area_strategy: "none"        # or "region_area" (requires regions table/geom)
  filters:
    start_time: null
    end_time: null
  anomaly_codes: null

baseline:
  method: "median"
  lookback_periods: 28
  min_history: 7
  seasonality: null

rules:
  count_anomaly:
    enabled: true
    method: "zscore"
    z_threshold: 3.0
    iqr_k: 1.5
    min_count: 3
  worsening:
    enabled: true
    method: "slope"
    slope_lookback: 7
    slope_min: 0.02
    min_periods: 5
    ewma_span: 7
    ewma_threshold: 0.6

alerting:
  dedup_cooldown_windows: 3
  resolve_after_no_anomaly: 3
  rate_limit_per_run: 100
  group_by_window: true

delivery:
  slack:
    enabled: false
    webhook_url: ""
  webhook:
    enabled: false
    url: ""
    headers: {}
  email:
    enabled: false
    smtp_host: ""
    smtp_port: 587
    username: ""
    password_env: "SMTP_PASSWORD"
    from_addr: ""
    to_addrs: []

run:
  dry_run: false

